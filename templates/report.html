{% extends "base.html" %}
{% block content %}
<h1>All Detections ({{ detections|length }})</h1><br>
<div class="d-flex justify-content-end">
    <a href="{{ url_for('export_csv') }}" class="btn btn-secondary me-2">Export CSV</a>
    <a href="{{ url_for('export_json') }}" class="btn btn-secondary">Export JSON</a>
</div>
{% if detections|length == 0 %}
    <p>No detections yet. <a href="{{ url_for('intake') }}">Add one</a>.</p>
{% else %}
<table class="detections-table">
    <thead><tr><th>Name</th><th>Env</th><th>Log Source</th><th>SIEM</th><th>ATT&CK</th><th>D3FEND</th><th>Added</th></tr></thead>
    <tbody>
        {% for det in detections %}
        <tr>
            <td>{{ det.name }}</td>
            <td>{{ det.environment }}</td>
            <td>{{ det.log_source }}</td>
            <td>{{ det.siem_type }}</td>
            <td>{{ det.attack_tactics or '—' }}</td>
            <td>{{ det.defend_tactics or '—' }}</td>
            <td>{{ det.created_at[:10] }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endblock %}